!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).TSNE=e()}}(function(){return function i(s,o,u){function l(r,e){if(!o[r]){if(!s[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var a=o[r]={exports:{}};s[r][0].call(a.exports,function(e){var t=s[r][1][e];return l(t||e)},a,a.exports,i,s,o,u)}return o[r].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}var s=e("./lib/thunk.js");t.exports=function(e){var t=new i;t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var n=0;n<r.length;++n){var a=r[n];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[n]="array",t.arrayArgs.push(n),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array args");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(n),t.shimArgs.push("scalar"+n);else if("index"===a){if(t.indexArgs.push(n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array index");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(n),n<t.pre.args.length&&t.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<t.post.args.length&&t.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+r[n]);t.argTypes[n]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(n)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,s(t)}},{"./lib/thunk.js":3}],2:[function(e,t,r){"use strict";function S(e,t,r){var n,a,i=e.length,s=t.arrayArgs.length,o=0<t.indexArgs.length,u=[],l=[],c=0,f=0;for(n=0;n<i;++n)l.push(["i",n,"=0"].join(""));for(a=0;a<s;++a)for(n=0;n<i;++n)f=c,c=e[n],0===n?l.push(["d",a,"s",n,"=t",a,"p",c].join("")):l.push(["d",a,"s",n,"=(t",a,"p",c,"-s",f,"*t",a,"p",f,")"].join(""));for(u.push("var "+l.join(",")),n=i-1;0<=n;--n)c=e[n],u.push(["for(i",n,"=0;i",n,"<s",c,";++i",n,"){"].join(""));for(u.push(r),n=0;n<i;++n){for(f=c,c=e[n],a=0;a<s;++a)u.push(["p",a,"+=d",a,"s",n].join(""));o&&(0<n&&u.push(["index[",f,"]-=s",f].join("")),u.push(["++index[",c,"]"].join(""))),u.push("}")}return u.join("\n")}function x(e,t,r){for(var n=e.body,a=[],i=[],s=0;s<e.args.length;++s){var o=e.args[s];if(!(o.count<=0)){var u=new RegExp(o.name,"g"),l="",c=t.arrayArgs.indexOf(s);switch(t.argTypes[s]){case"offset":var f=t.offsetArgIndex.indexOf(s);c=t.offsetArgs[f].array,l="+q"+f;case"array":l="p"+c+l;var p="l"+s,h="a"+c;if(0===t.arrayBlockIndices[c])1===o.count?"generic"===r[c]?o.lvalue?(a.push(["var ",p,"=",h,".get(",l,")"].join("")),n=n.replace(u,p),i.push([h,".set(",l,",",p,")"].join(""))):n=n.replace(u,[h,".get(",l,")"].join("")):n=n.replace(u,[h,"[",l,"]"].join("")):"generic"===r[c]?(a.push(["var ",p,"=",h,".get(",l,")"].join("")),n=n.replace(u,p),o.lvalue&&i.push([h,".set(",l,",",p,")"].join(""))):(a.push(["var ",p,"=",h,"[",l,"]"].join("")),n=n.replace(u,p),o.lvalue&&i.push([h,"[",l,"]=",p].join("")));else{for(var d=[o.name],m=[l],y=0;y<Math.abs(t.arrayBlockIndices[c]);y++)d.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(y+1)+"*t"+c+"b"+y);if(u=new RegExp(d.join(""),"g"),l=m.join("+"),"generic"===r[c])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(u,[h,"[",l,"]"].join(""))}break;case"scalar":n=n.replace(u,"Y"+t.scalarArgs.indexOf(s));break;case"index":n=n.replace(u,"index");break;case"shape":n=n.replace(u,"shape")}}}return[a.join("\n"),n,i.join("\n")].join("\n").trim()}var E=e("uniq");t.exports=function(e,t){for(var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,n=new Array(e.arrayArgs.length),a=new Array(e.arrayArgs.length),i=0;i<e.arrayArgs.length;++i)a[i]=t[2*i],n[i]=t[2*i+1];var s=[],o=[],u=[],l=[],c=[];for(i=0;i<e.arrayArgs.length;++i){e.arrayBlockIndices[i]<0?(u.push(0),l.push(r),s.push(r),o.push(r+e.arrayBlockIndices[i])):(u.push(e.arrayBlockIndices[i]),l.push(e.arrayBlockIndices[i]+r),s.push(0),o.push(e.arrayBlockIndices[i]));for(var f=[],p=0;p<n[i].length;p++)u[i]<=n[i][p]&&n[i][p]<l[i]&&f.push(n[i][p]-u[i]);c.push(f)}var h=["SS"],d=["'use strict'"],m=[];for(p=0;p<r;++p)m.push(["s",p,"=SS[",p,"]"].join(""));for(i=0;i<e.arrayArgs.length;++i){for(h.push("a"+i),h.push("t"+i),h.push("p"+i),p=0;p<r;++p)m.push(["t",i,"p",p,"=t",i,"[",u[i]+p,"]"].join(""));for(p=0;p<Math.abs(e.arrayBlockIndices[i]);++p)m.push(["t",i,"b",p,"=t",i,"[",s[i]+p,"]"].join(""))}for(i=0;i<e.scalarArgs.length;++i)h.push("Y"+i);if(0<e.shapeArgs.length&&m.push("shape=SS.slice(0)"),0<e.indexArgs.length){var y=new Array(r);for(i=0;i<r;++i)y[i]="0";m.push(["index=[",y.join(","),"]"].join(""))}for(i=0;i<e.offsetArgs.length;++i){var g=e.offsetArgs[i],v=[];for(p=0;p<g.offset.length;++p)0!==g.offset[p]&&(1===g.offset[p]?v.push(["t",g.array,"p",p].join("")):v.push([g.offset[p],"*t",g.array,"p",p].join("")));0===v.length?m.push("q"+i+"=0"):m.push(["q",i,"=",v.join("+")].join(""))}var b=E([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for(m=m.concat(b),d.push("var "+m.join(",")),i=0;i<e.arrayArgs.length;++i)d.push("p"+i+"|=0");3<e.pre.body.length&&d.push(x(e.pre,e,a));var _=x(e.body,e,a),w=function(e){for(var t=0,r=e[0].length;t<r;){for(var n=1;n<e.length;++n)if(e[n][t]!==e[0][t])return t;++t}return t}(c);w<r?d.push(function(e,t,r,n){for(var a=t.length,i=r.arrayArgs.length,s=r.blockSize,o=0<r.indexArgs.length,u=[],l=0;l<i;++l)u.push(["var offset",l,"=p",l].join(""));for(l=e;l<a;++l)u.push(["for(var j"+l+"=SS[",t[l],"]|0;j",l,">0;){"].join("")),u.push(["if(j",l,"<",s,"){"].join("")),u.push(["s",t[l],"=j",l].join("")),u.push(["j",l,"=0"].join("")),u.push(["}else{s",t[l],"=",s].join("")),u.push(["j",l,"-=",s,"}"].join("")),o&&u.push(["index[",t[l],"]=j",l].join(""));for(l=0;l<i;++l){for(var c=["offset"+l],f=e;f<a;++f)c.push(["j",f,"*t",l,"p",t[f]].join(""));u.push(["p",l,"=(",c.join("+"),")"].join(""))}for(u.push(S(t,r,n)),l=e;l<a;++l)u.push("}");return u.join("\n")}(w,c[0],e,_)):d.push(S(c[0],e,_)),3<e.post.body.length&&d.push(x(e.post,e,a)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+d.join("\n")+"\n----------");var k=[e.funcName||"unnamed","_cwise_loop_",n[0].join("s"),"m",w,function(e){for(var t=new Array(e.length),r=!0,n=0;n<e.length;++n){var a=e[n],i=a.match(/\d+/);i=i?i[0]:"",0===a.charAt(0)?t[n]="u"+a.charAt(1)+i:t[n]=a.charAt(0)+i,0<n&&(r=r&&t[n]===t[n-1])}return r?t[0]:t.join("")}(a)].join("");return new Function(["function ",k,"(",h.join(","),"){",d.join("\n"),"} return ",k].join(""))()}},{uniq:17}],3:[function(e,t,r){"use strict";var f=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],r=[],n=e.funcName+"_cwise_thunk";t.push(["return function ",n,"(",e.shimArgs.join(","),"){"].join(""));for(var a=[],i=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],o=[],u=[],l=0;l<e.arrayArgs.length;++l){var c=e.arrayArgs[l];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),a.push("t"+c),a.push("r"+c),i.push("t"+c),i.push("r"+c+".join()"),s.push("array"+c+".data"),s.push("array"+c+".stride"),s.push("array"+c+".offset|0"),0<l&&(o.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[l]))),u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[l])+"]"))}for(1<e.arrayArgs.length&&(t.push("if (!("+o.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),l=0;l<e.scalarArgs.length;++l)s.push("scalar"+e.scalarArgs[l]);return r.push(["type=[",i.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),t.push("var "+r.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(f.bind(void 0,e))}},{"./compile.js":2}],4:[function(e,t,r){"use strict";function o(e,t,r){this.name=e,this.lvalue=t,this.rvalue=r,this.count=0}function u(e,t,r,n){this.body=e,this.args=t,this.thisVars=r,this.localVars=n}var l=e("esprima"),c=e("uniq"),f=0;t.exports=function(e){function y(e,t){for(var r=e.range[0],n=e.range[1],a=r+1;a<n;++a)i[a]="";i[r]=t}for(var t=["(",e,")()"].join(""),r=l.parse(t,{range:!0}),g="_inline_"+f+++"_",v=function(e){for(var t=e.body[0].expression.callee.params,r=new Array(t.length),n=0;n<t.length;++n)r[n]=t[n].name;return r}(r),b=new Array(v.length),n=0;n<v.length;++n)b[n]=new o([g,"arg",n,"_"].join(""),!1,!1);for(var i=new Array(t.length),a=(n=0,t.length);n<a;++n)i[n]=t.charAt(n);var s,_=[],w=[];return function e(t,r){if(t.parent=r,"MemberExpression"===t.type)t.computed?(e(t.object,t),e(t.property,t)):"ThisExpression"===t.object.type?y(t,(d=t.property.name,m="this_"+d.replace(/\_/g,"__"),w.push(m),m)):e(t.object,t);else{if("ThisExpression"===t.type)throw new Error("cwise-parser: Computed this is not allowed");if("Identifier"===t.type){var n=t.name,a=v.indexOf(n);if(0<=a){var i=b[a],s="AssignmentExpression"===(h=t).parent.type&&h.parent.left===h?"="===h.parent.operator?1:3:"UpdateExpression"===h.parent.type?3:2;1&s&&(i.lvalue=!0),2&s&&(i.rvalue=!0),++i.count,y(t,i.name)}else(function(e){if("eval"===e)throw new Error("cwise-parser: eval() not allowed");return"undefined"!=typeof window?e in window:"undefined"!=typeof GLOBAL?e in GLOBAL:"undefined"!=typeof self&&e in self})(n)||y(t,(p=g+n.replace(/\_/g,"__"),_.push(p),p))}else if("Literal"===t.type)"string"==typeof t.value&&y(t,"'"+t.value.replace(/\_/g,"\\_").replace(/\'/g,"'")+"'");else{if("WithStatement"===t.type)throw new Error("cwise-parser: with() statements not allowed");for(var o=Object.keys(t),u=0,l=o.length;u<l;++u)if("parent"!==o[u]){var c=t[o[u]];if(c)if(c instanceof Array)for(var f=0;f<c.length;++f)c[f]&&"string"==typeof c[f].type&&e(c[f],t);else"string"==typeof c.type&&e(c,t)}}}var p,h,d,m}(r.body[0].expression.callee.body,void 0),c(_),c(w),new u((s=r.body[0].expression.callee.body,i.slice(s.range[0],s.range[1]).join("")),b,w,_)}},{esprima:8,uniq:17}],5:[function(e,t,r){"use strict";var n=e("cwise-parser"),a=e("cwise-compiler"),i=["args","body"],s=["pre","post","printCode","funcName","blockSize"];t.exports=function(e){for(var t in e)i.indexOf(t)<0&&s.indexOf(t)<0&&console.warn("cwise: Unknown argument '"+t+"' passed to expression compiler");for(var r=0;r<i.length;++r)if(!e[i[r]])throw new Error("cwise: Missing argument: "+i[r]);return a({args:e.args,pre:n(e.pre||function(){}),body:n(e.body),post:n(e.post||function(){}),debug:!!e.printCode,funcName:e.funcName||e.body.name||"cwise",blockSize:e.blockSize||64})}},{"cwise-compiler":1,"cwise-parser":4}],6:[function(e,t,r){t.exports=e("cwise-compiler")},{"cwise-compiler":1}],7:[function(e,t,r){"use strict";t.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(0<e)return function(e,t){var r,n;for(r=new Array(e),n=0;n<e;++n)r[n]=t;return r}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,r,n){var a=0|t[n];if(a<=0)return[];var i,s=new Array(a);if(n===t.length-1)for(i=0;i<a;++i)s[i]=r;else for(i=0;i<a;++i)s[i]=e(t,r,n+1);return s}(e,t,0)}return[]}},{}],8:[function(e,t,r){!function(e,t){"use strict";t(void 0!==r?r:e.esprima={})}(this,function(e){"use strict";function c(e,t){if(!e)throw new Error("ASSERT: "+t)}function n(e){return 48<=e&&e<=57}function i(e){return 0<="0123456789abcdefABCDEF".indexOf(e)}function f(e){return 0<="01234567".indexOf(e)}function p(e){return 10===e||13===e||8232===e||8233===e}function x(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||92===e||128<=e&&ye.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function a(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||92===e||128<=e&&ye.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function m(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function y(e){return"eval"===e||"arguments"===e}function s(e,t,r,n,a){var i;c("number"==typeof r,"Comment must have valid position"),Ae.lastCommentStart>=r||(Ae.lastCommentStart=r,i={type:e,value:t},Ie.range&&(i.range=[r,n]),Ie.loc&&(i.loc=a),Ie.comments.push(i),Ie.attachComment&&(Ie.leadingComments.push(i),Ie.trailingComments.push(i)))}function o(e){var t,r,n,a;for(t=_e-e,r={start:{line:we,column:_e-ke-e}};_e<Se;)if(n=ve.charCodeAt(_e),++_e,p(n))return Ie.comments&&(a=ve.slice(t+e,_e-1),r.end={line:we,column:_e-ke-1},s("Line",a,t,_e-1,r)),13===n&&10===ve.charCodeAt(_e)&&++_e,++we,void(ke=_e);Ie.comments&&(a=ve.slice(t+e,_e),r.end={line:we,column:_e-ke},s("Line",a,t,_e,r))}function u(){var e,t,r,n;for(Ie.comments&&(e=_e-2,t={start:{line:we,column:_e-ke-2}});_e<Se;)if(p(r=ve.charCodeAt(_e)))13===r&&10===ve.charCodeAt(_e+1)&&++_e,++we,Se<=(ke=++_e)&&j({},me.UnexpectedToken,"ILLEGAL");else if(42===r){if(47===ve.charCodeAt(_e+1))return++_e,++_e,void(Ie.comments&&(n=ve.slice(e+2,_e-2),t.end={line:we,column:_e-ke},s("Block",n,e,_e,t)));++_e}else++_e;j({},me.UnexpectedToken,"ILLEGAL")}function E(){var e,t,r;for(t=0===_e;_e<Se;)if(e=ve.charCodeAt(_e),32===(r=e)||9===r||11===r||12===r||160===r||5760<=r&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(r))++_e;else if(p(e))++_e,13===e&&10===ve.charCodeAt(_e)&&++_e,++we,ke=_e,t=!0;else if(47===e)if(47===(e=ve.charCodeAt(_e+1)))++_e,++_e,o(2),t=!0;else{if(42!==e)break;++_e,++_e,u()}else if(t&&45===e){if(45!==ve.charCodeAt(_e+1)||62!==ve.charCodeAt(_e+2))break;_e+=3,o(3)}else{if(60!==e)break;if("!--"!==ve.slice(_e+1,_e+4))break;++_e,++_e,++_e,++_e,o(4)}}function h(e){var t,r,n,a=0;for(r="u"===e?4:2,t=0;t<r;++t){if(!(_e<Se&&i(ve[_e])))return"";n=ve[_e++],a=16*a+"0123456789abcdef".indexOf(n.toLowerCase())}return String.fromCharCode(a)}function r(){var e,t;for(e=ve.charCodeAt(_e++),t=String.fromCharCode(e),92===e&&(117!==ve.charCodeAt(_e)&&j({},me.UnexpectedToken,"ILLEGAL"),++_e,(e=h("u"))&&"\\"!==e&&x(e.charCodeAt(0))||j({},me.UnexpectedToken,"ILLEGAL"),t=e);_e<Se&&a(e=ve.charCodeAt(_e));)++_e,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==ve.charCodeAt(_e)&&j({},me.UnexpectedToken,"ILLEGAL"),++_e,(e=h("u"))&&"\\"!==e&&a(e.charCodeAt(0))||j({},me.UnexpectedToken,"ILLEGAL"),t+=e);return t}function t(){var e,t;return e=_e,{type:1===(t=92===ve.charCodeAt(_e)?r():function(){var e,t;for(e=_e++;_e<Se;){if(92===(t=ve.charCodeAt(_e)))return _e=e,r();if(!a(t))break;++_e}return ve.slice(e,_e)}()).length?ce.Identifier:function(e){if(be&&m(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}(t)?ce.Keyword:"null"===t?ce.NullLiteral:"true"===t||"false"===t?ce.BooleanLiteral:ce.Identifier,value:t,lineNumber:we,lineStart:ke,start:e,end:_e}}function l(){var e,t,r,n,a=_e,i=ve.charCodeAt(_e),s=ve[_e];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_e,Ie.tokenize&&(40===i?Ie.openParenToken=Ie.tokens.length:123===i&&(Ie.openCurlyToken=Ie.tokens.length)),{type:ce.Punctuator,value:String.fromCharCode(i),lineNumber:we,lineStart:ke,start:a,end:_e};default:if(61===(e=ve.charCodeAt(_e+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _e+=2,{type:ce.Punctuator,value:String.fromCharCode(i)+String.fromCharCode(e),lineNumber:we,lineStart:ke,start:a,end:_e};case 33:case 61:return _e+=2,61===ve.charCodeAt(_e)&&++_e,{type:ce.Punctuator,value:ve.slice(a,_e),lineNumber:we,lineStart:ke,start:a,end:_e}}}return">>>="===(n=ve.substr(_e,4))?(_e+=4,{type:ce.Punctuator,value:n,lineNumber:we,lineStart:ke,start:a,end:_e}):">>>"===(r=n.substr(0,3))||"<<="===r||">>="===r?(_e+=3,{type:ce.Punctuator,value:r,lineNumber:we,lineStart:ke,start:a,end:_e}):s===(t=r.substr(0,2))[1]&&0<="+-<>&|".indexOf(s)||"=>"===t?(_e+=2,{type:ce.Punctuator,value:t,lineNumber:we,lineStart:ke,start:a,end:_e}):0<="<>=!+-*%&|^/".indexOf(s)?(++_e,{type:ce.Punctuator,value:s,lineNumber:we,lineStart:ke,start:a,end:_e}):void j({},me.UnexpectedToken,"ILLEGAL")}function d(){var e,t,r;if(c(n((r=ve[_e]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),t=_e,e="","."!==r){if(e=ve[_e++],r=ve[_e],"0"===e){if("x"===r||"X"===r)return++_e,function(e){for(var t="";_e<Se&&i(ve[_e]);)t+=ve[_e++];return 0===t.length&&j({},me.UnexpectedToken,"ILLEGAL"),x(ve.charCodeAt(_e))&&j({},me.UnexpectedToken,"ILLEGAL"),{type:ce.NumericLiteral,value:parseInt("0x"+t,16),lineNumber:we,lineStart:ke,start:e,end:_e}}(t);if(f(r)&&function(){var e,t;for(e=_e+1;e<Se;++e){if("8"===(t=ve[e])||"9"===t)return!1;if(!f(t))return!0}return!0}())return function(e){for(var t="0"+ve[_e++];_e<Se&&f(ve[_e]);)t+=ve[_e++];return(x(ve.charCodeAt(_e))||n(ve.charCodeAt(_e)))&&j({},me.UnexpectedToken,"ILLEGAL"),{type:ce.NumericLiteral,value:parseInt(t,8),octal:!0,lineNumber:we,lineStart:ke,start:e,end:_e}}(t)}for(;n(ve.charCodeAt(_e));)e+=ve[_e++];r=ve[_e]}if("."===r){for(e+=ve[_e++];n(ve.charCodeAt(_e));)e+=ve[_e++];r=ve[_e]}if("e"===r||"E"===r)if(e+=ve[_e++],("+"===(r=ve[_e])||"-"===r)&&(e+=ve[_e++]),n(ve.charCodeAt(_e)))for(;n(ve.charCodeAt(_e));)e+=ve[_e++];else j({},me.UnexpectedToken,"ILLEGAL");return x(ve.charCodeAt(_e))&&j({},me.UnexpectedToken,"ILLEGAL"),{type:ce.NumericLiteral,value:parseFloat(e),lineNumber:we,lineStart:ke,start:t,end:_e}}function g(){var e,t,r,n;return Ee=null,E(),e=_e,t=function(){var e,t,r,n;for(c("/"===(e=ve[_e]),"Regular expression literal must start with a slash"),t=ve[_e++],n=r=!1;_e<Se;)if(t+=e=ve[_e++],"\\"===e)p((e=ve[_e++]).charCodeAt(0))&&j({},me.UnterminatedRegExp),t+=e;else if(p(e.charCodeAt(0)))j({},me.UnterminatedRegExp);else if(r)"]"===e&&(r=!1);else{if("/"===e){n=!0;break}"["===e&&(r=!0)}return n||j({},me.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}(),r=function(){var e,t,r,n;for(r=t="";_e<Se&&a((e=ve[_e]).charCodeAt(0));)if(++_e,"\\"===e&&_e<Se)if("u"===(e=ve[_e])){if(n=++_e,e=h("u"))for(r+=e,t+="\\u";n<_e;++n)t+=ve[n];else _e=n,r+="u",t+="\\u";C({},me.UnexpectedToken,"ILLEGAL")}else t+="\\",C({},me.UnexpectedToken,"ILLEGAL");else r+=e,t+=e;return{value:r,literal:t}}(),n=function(e,t){var r;try{r=new RegExp(e,t)}catch(e){j({},me.InvalidRegExp)}return r}(t.value,r.value),Ie.tokenize?{type:ce.RegularExpression,value:n,lineNumber:we,lineStart:ke,start:e,end:_e}:{literal:t.literal+r.literal,value:n,start:e,end:_e}}function v(){var e,t,r,n;return E(),t={start:{line:we,column:(e=_e)-ke}},r=g(),t.end={line:we,column:_e-ke},Ie.tokenize||(0<Ie.tokens.length&&((n=Ie.tokens[Ie.tokens.length-1]).range[0]===e&&"Punctuator"===n.type&&("/"===n.value||"/="===n.value)&&Ie.tokens.pop()),Ie.tokens.push({type:"RegularExpression",value:r.literal,range:[e,_e],loc:t})),r}function b(){var e;return E(),Se<=_e?{type:ce.EOF,lineNumber:we,lineStart:ke,start:_e,end:_e}:x(e=ve.charCodeAt(_e))?t():40===e||41===e||59===e?l():39===e||34===e?function(){var e,t,r,n,a,i,s,o,u="",l=!1;for(s=we,o=ke,c("'"===(e=ve[_e])||'"'===e,"String literal must starts with a quote"),t=_e,++_e;_e<Se;){if((r=ve[_e++])===e){e="";break}if("\\"===r)if((r=ve[_e++])&&p(r.charCodeAt(0)))++we,"\r"===r&&"\n"===ve[_e]&&++_e,ke=_e;else switch(r){case"u":case"x":i=_e,(a=h(r))?u+=a:(_e=i,u+=r);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:f(r)?(0!==(n="01234567".indexOf(r))&&(l=!0),_e<Se&&f(ve[_e])&&(l=!0,n=8*n+"01234567".indexOf(ve[_e++]),0<="0123".indexOf(r)&&_e<Se&&f(ve[_e])&&(n=8*n+"01234567".indexOf(ve[_e++]))),u+=String.fromCharCode(n)):u+=r}else{if(p(r.charCodeAt(0)))break;u+=r}}return""!==e&&j({},me.UnexpectedToken,"ILLEGAL"),{type:ce.StringLiteral,value:u,octal:l,startLineNumber:s,startLineStart:o,lineNumber:we,lineStart:ke,start:t,end:_e}}():46===e?n(ve.charCodeAt(_e+1))?d():l():n(e)?d():Ie.tokenize&&47===e?function(){var e,t;if(!(e=Ie.tokens[Ie.tokens.length-1]))return v();if("Punctuator"===e.type){if("]"===e.value)return l();if(")"===e.value)return!(t=Ie.tokens[Ie.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?l():v();if("}"===e.value){if(Ie.tokens[Ie.openCurlyToken-3]&&"Keyword"===Ie.tokens[Ie.openCurlyToken-3].type){if(!(t=Ie.tokens[Ie.openCurlyToken-4]))return l()}else{if(!Ie.tokens[Ie.openCurlyToken-4]||"Keyword"!==Ie.tokens[Ie.openCurlyToken-4].type)return l();if(!(t=Ie.tokens[Ie.openCurlyToken-5]))return v()}return 0<=pe.indexOf(t.value)?l():v()}return v()}return"Keyword"===e.type&&"this"!==e.value?v():l()}():l()}function _(){var e,t,r;return E(),e={start:{line:we,column:_e-ke}},t=b(),e.end={line:we,column:_e-ke},t.type!==ce.EOF&&(r=ve.slice(t.start,t.end),Ie.tokens.push({type:fe[t.type],value:r,range:[t.start,t.end],loc:e})),t}function A(){var e;return _e=(e=Ee).end,we=e.lineNumber,ke=e.lineStart,Ee=void 0!==Ie.tokens?_():b(),_e=e.end,we=e.lineNumber,ke=e.lineStart,e}function w(){var e,t,r;e=_e,t=we,r=ke,Ee=void 0!==Ie.tokens?_():b(),_e=e,we=t,ke=r}function k(e,t){this.line=e,this.column=t}function S(e,t,r,n){this.start=new k(e,t),this.end=new k(r,n)}function I(){var e,t,r,n;return e=_e,t=we,r=ke,E(),n=we!==t,_e=e,we=t,ke=r,n}function j(e,t){var r,n=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,function(e,t){return c(t<n.length,"Message reference must be in range"),n[t]});throw"number"==typeof e.lineNumber?((r=new Error("Line "+e.lineNumber+": "+a)).index=e.start,r.lineNumber=e.lineNumber,r.column=e.start-ke+1):((r=new Error("Line "+we+": "+a)).index=_e,r.lineNumber=we,r.column=_e-ke+1),r.description=a,r}function C(){try{j.apply(null,arguments)}catch(e){if(!Ie.errors)throw e;Ie.errors.push(e)}}function L(e){if(e.type===ce.EOF&&j(e,me.UnexpectedEOS),e.type===ce.NumericLiteral&&j(e,me.UnexpectedNumber),e.type===ce.StringLiteral&&j(e,me.UnexpectedString),e.type===ce.Identifier&&j(e,me.UnexpectedIdentifier),e.type===ce.Keyword){if(function(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}(e.value))j(e,me.UnexpectedReserved);else if(be&&m(e.value))return void C(e,me.StrictReservedWord);j(e,me.UnexpectedToken,e.value)}j(e,me.UnexpectedToken,e.value)}function V(e){var t=A();(t.type!==ce.Punctuator||t.value!==e)&&L(t)}function N(e){var t=A();(t.type!==ce.Keyword||t.value!==e)&&L(t)}function O(e){return Ee.type===ce.Punctuator&&Ee.value===e}function P(e){return Ee.type===ce.Keyword&&Ee.value===e}function M(){var e,t=_e,r=we,n=ke,a=Ee;return 59===ve.charCodeAt(_e)||O(";")?void A():(e=we,E(),we!==e?(_e=t,we=r,ke=n,void(Ee=a)):void(Ee.type===ce.EOF||O("}")||L(Ee)))}function F(e){return e.type===he.Identifier||e.type===he.MemberExpression}function T(e,t){var r,n,a;return r=be,a=Ee,n=ae(),t&&be&&y(e[0].name)&&C(t,me.StrictParamName),be=r,xe.markEnd(xe.createFunctionExpression(null,e,[],n),a)}function q(){var e,t;return t=Ee,(e=A()).type===ce.StringLiteral||e.type===ce.NumericLiteral?(be&&e.octal&&C(e,me.StrictOctalLiteral),xe.markEnd(xe.createLiteral(e),t)):xe.markEnd(xe.createIdentifier(e.value),t)}function U(){var e,t,r,n,a,i,s,o,u,l,c,f,p,h,d;if(O("("))return V("("),a=Y(),V(")"),a;if(O("["))return function(){var e,t=[];for(e=Ee,V("[");!O("]");)O(",")?(A(),t.push(null)):(t.push(X()),O("]")||V(","));return A(),xe.markEnd(xe.createArrayExpression(t),e)}();if(O("{"))return function(){var e,t,r,n,a,i,s,o,u,l,c,f=[],p={},h=String;for(a=Ee,V("{");!O("}");)c=l=u=o=s=i=void 0,c=i=Ee,t=(e=i.type===ce.Identifier?(o=q(),"get"!==i.value||O(":")?"set"!==i.value||O(":")?(V(":"),u=X(),xe.markEnd(xe.createProperty("init",o,u),c)):(s=q(),V("("),(i=Ee).type!==ce.Identifier?(V(")"),C(i,me.UnexpectedToken,i.value),u=T([])):(l=[Q()],V(")"),u=T(l,i)),xe.markEnd(xe.createProperty("set",s,u),c)):(s=q(),V("("),V(")"),u=T([]),xe.markEnd(xe.createProperty("get",s,u),c))):i.type!==ce.EOF&&i.type!==ce.Punctuator?(s=q(),V(":"),u=X(),xe.markEnd(xe.createProperty("init",s,u),c)):void L(i)).key.type===he.Identifier?e.key.name:h(e.key.value),n="init"===e.kind?de.Data:"get"===e.kind?de.Get:de.Set,r="$"+t,Object.prototype.hasOwnProperty.call(p,r)?(p[r]===de.Data?be&&n===de.Data?C({},me.StrictDuplicateProperty):n!==de.Data&&C({},me.AccessorDataProperty):n===de.Data?C({},me.AccessorDataProperty):p[r]&n&&C({},me.AccessorGetSet),p[r]|=n):p[r]=n,f.push(e),O("}")||V(",");return V("}"),xe.markEnd(xe.createObjectExpression(f),a)}();if(e=Ee.type,n=Ee,e===ce.Identifier)r=xe.createIdentifier(A().value);else if(e===ce.StringLiteral||e===ce.NumericLiteral)be&&Ee.octal&&C(Ee,me.StrictOctalLiteral),r=xe.createLiteral(A());else if(e===ce.Keyword){if(P("function"))return h=null,d=[],p=Ee,N("function"),O("(")||(i=Ee,h=Q(),be?y(i.value)&&C(i,me.StrictFunctionName):y(i.value)?(o=i,u=me.StrictFunctionName):m(i.value)&&(o=i,u=me.StrictReservedWord)),l=ie(o),d=l.params,s=l.stricted,o=l.firstRestricted,l.message&&(u=l.message),f=be,c=ae(),be&&o&&j(o,u),be&&s&&C(s,u),be=f,xe.markEnd(xe.createFunctionExpression(h,d,[],c),p);P("this")?(A(),r=xe.createThisExpression()):L(A())}else e===ce.BooleanLiteral?((t=A()).value="true"===t.value,r=xe.createLiteral(t)):e===ce.NullLiteral?((t=A()).value=null,r=xe.createLiteral(t)):O("/")||O("/=")?(r=void 0!==Ie.tokens?xe.createLiteral(v()):xe.createLiteral(g()),w()):L(A());return xe.markEnd(r,n)}function D(){var e=[];if(V("("),!O(")"))for(;_e<Se&&(e.push(X()),!O(")"));)V(",");return V(")"),e}function R(){var e,t,r;return t=Ee,e=A(),(r=e).type===ce.Identifier||r.type===ce.Keyword||r.type===ce.BooleanLiteral||r.type===ce.NullLiteral||L(e),xe.markEnd(xe.createIdentifier(e.value),t)}function B(){return V("."),R()}function z(){var e;return V("["),e=Y(),V("]"),e}function G(){var e,t,r;return r=Ee,N("new"),e=function(){var e,t,r;for(c(Ae.allowIn,"callee of new expression always allow in keyword."),r=Ee,e=P("new")?G():U();O(".")||O("[");)O("[")?(t=z(),e=xe.createMemberExpression("[",e,t)):(t=B(),e=xe.createMemberExpression(".",e,t)),xe.markEnd(e,r);return e}(),t=O("(")?D():[],xe.markEnd(xe.createNewExpression(e,t),r)}function W(){var e,t,r=Ee;return e=function(){var e,t,r,n,a=Ae.allowIn;for(n=Ee,Ae.allowIn=!0,e=P("new")?G():U();;){if(O("."))r=B(),e=xe.createMemberExpression(".",e,r);else if(O("("))t=D(),e=xe.createCallExpression(e,t);else{if(!O("["))break;r=z(),e=xe.createMemberExpression("[",e,r)}xe.markEnd(e,n)}return Ae.allowIn=a,e}(),Ee.type===ce.Punctuator&&(!O("++")&&!O("--")||I()||(be&&e.type===he.Identifier&&y(e.name)&&C({},me.StrictLHSPostfix),F(e)||C({},me.InvalidLHSInAssignment),t=A(),e=xe.markEnd(xe.createPostfixExpression(t.value,e),r))),e}function K(){var e,t,r;return Ee.type!==ce.Punctuator&&Ee.type!==ce.Keyword?t=W():O("++")||O("--")?(r=Ee,e=A(),t=K(),be&&t.type===he.Identifier&&y(t.name)&&C({},me.StrictLHSPrefix),F(t)||C({},me.InvalidLHSInAssignment),t=xe.createUnaryExpression(e.value,t),t=xe.markEnd(t,r)):O("+")||O("-")||O("~")||O("!")?(r=Ee,e=A(),t=K(),t=xe.createUnaryExpression(e.value,t),t=xe.markEnd(t,r)):P("delete")||P("void")||P("typeof")?(r=Ee,e=A(),t=K(),t=xe.createUnaryExpression(e.value,t),t=xe.markEnd(t,r),be&&"delete"===t.operator&&t.argument.type===he.Identifier&&C({},me.StrictDelete)):t=W(),t}function H(e,t){var r=0;if(e.type!==ce.Punctuator&&e.type!==ce.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=t?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function $(){var e,t,r,n,a;return a=Ee,e=function(){var e,t,r,n,a,i,s,o,u,l;if(e=Ee,u=K(),0===(a=H(n=Ee,Ae.allowIn)))return u;for(n.prec=a,A(),t=[e,Ee],i=[u,n,s=K()];0<(a=H(Ee,Ae.allowIn));){for(;2<i.length&&a<=i[i.length-2].prec;)s=i.pop(),o=i.pop().value,u=i.pop(),r=xe.createBinaryExpression(o,u,s),t.pop(),e=t[t.length-1],xe.markEnd(r,e),i.push(r);(n=A()).prec=a,i.push(n),t.push(Ee),r=K(),i.push(r)}for(r=i[l=i.length-1],t.pop();1<l;)r=xe.createBinaryExpression(i[l-1].value,i[l-2],r),l-=2,e=t.pop(),xe.markEnd(r,e);return r}(),O("?")&&(A(),t=Ae.allowIn,Ae.allowIn=!0,r=X(),Ae.allowIn=t,V(":"),n=X(),e=xe.createConditionalExpression(e,r,n),xe.markEnd(e,a)),e}function X(){var e,t,r,n,a,i;return a=e=Ee,n=t=$(),Ee.type===ce.Punctuator&&("="===(i=Ee.value)||"*="===i||"/="===i||"%="===i||"+="===i||"-="===i||"<<="===i||">>="===i||">>>="===i||"&="===i||"^="===i||"|="===i)&&(F(t)||C({},me.InvalidLHSInAssignment),be&&t.type===he.Identifier&&y(t.name)&&C(e,me.StrictLHSAssignment),e=A(),r=X(),n=xe.markEnd(xe.createAssignmentExpression(e.value,t,r),a)),n}function Y(){var e,t=Ee;if(e=X(),O(",")){for(e=xe.createSequenceExpression([e]);_e<Se&&O(",");)A(),e.expressions.push(X());xe.markEnd(e,t)}return e}function J(){var e,t;return t=Ee,V("{"),e=function(){for(var e,t=[];_e<Se&&!O("}")&&void 0!==(e=oe());)t.push(e);return t}(),V("}"),xe.markEnd(xe.createBlockStatement(e),t)}function Q(){var e,t;return t=Ee,(e=A()).type!==ce.Identifier&&L(e),xe.markEnd(xe.createIdentifier(e.value),t)}function Z(e){var t,r,n,a,i=[];do{if(i.push((t=e,a=n=r=void 0,a=null,n=Ee,r=Q(),be&&y(r.name)&&C({},me.StrictVarName),"const"===t?(V("="),a=X()):O("=")&&(A(),a=X()),xe.markEnd(xe.createVariableDeclarator(r,a),n))),!O(","))break;A()}while(_e<Se);return i}function ee(){var e,t,r,n,a,i,s,o,u,l,c=Ae.allowIn;return e=t=r=null,N("for"),V("("),O(";")?A():(P("var")||P("let")?(Ae.allowIn=!1,l=Ee,o=A(),u=Z(),e=xe.markEnd(xe.createVariableDeclaration(u,o.value),l),Ae.allowIn=c,1===e.declarations.length&&P("in")&&(A(),n=e,a=Y(),e=null)):(Ae.allowIn=!1,e=Y(),Ae.allowIn=c,P("in")&&(F(e)||C({},me.InvalidLHSInForIn),A(),n=e,a=Y(),e=null)),void 0===n&&V(";")),void 0===n&&(O(";")||(t=Y()),V(";"),O(")")||(r=Y())),V(")"),s=Ae.inIteration,Ae.inIteration=!0,i=ne(),Ae.inIteration=s,void 0===n?xe.createForStatement(e,t,r,i):xe.createForInStatement(n,a,i)}function te(){var e,t,r,n=[];for(r=Ee,P("default")?(A(),e=null):(N("case"),e=Y()),V(":");_e<Se&&!(O("}")||P("default")||P("case"));)t=ne(),n.push(t);return xe.markEnd(xe.createSwitchCase(e,n),r)}function re(){var e,t,r,n,a=[],i=null;return N("try"),e=J(),P("catch")&&a.push((n=Ee,N("catch"),V("("),O(")")&&L(Ee),t=Q(),be&&y(t.name)&&C({},me.StrictCatchVariable),V(")"),r=J(),xe.markEnd(xe.createCatchClause(t,r),n))),P("finally")&&(A(),i=J()),0!==a.length||i||j({},me.NoCatchOrFinally),xe.createTryStatement(e,[],a,i)}function ne(){var e,t,r,n,a,i,s,o,u,l,c,f,p,h,d,m,y,g,v,b,_,w,k,S=Ee.type;if(S===ce.EOF&&L(Ee),S===ce.Punctuator&&"{"===Ee.value)return J();if(n=Ee,S===ce.Punctuator)switch(Ee.value){case";":return xe.markEnd((V(";"),xe.createEmptyStatement()),n);case"(":return xe.markEnd((a=Y(),M(),xe.createExpressionStatement(a)),n)}if(S===ce.Keyword)switch(Ee.value){case"break":return xe.markEnd((k=null,N("break"),59===ve.charCodeAt(_e)?(A(),Ae.inIteration||Ae.inSwitch||j({},me.IllegalBreak),xe.createBreakStatement(null)):I()?(Ae.inIteration||Ae.inSwitch||j({},me.IllegalBreak),xe.createBreakStatement(null)):(Ee.type===ce.Identifier&&(w="$"+(k=Q()).name,Object.prototype.hasOwnProperty.call(Ae.labelSet,w)||j({},me.UnknownLabel,k.name)),M(),null!==k||Ae.inIteration||Ae.inSwitch||j({},me.IllegalBreak),xe.createBreakStatement(k))),n);case"continue":return xe.markEnd((_=null,N("continue"),59===ve.charCodeAt(_e)?(A(),Ae.inIteration||j({},me.IllegalContinue),xe.createContinueStatement(null)):I()?(Ae.inIteration||j({},me.IllegalContinue),xe.createContinueStatement(null)):(Ee.type===ce.Identifier&&(b="$"+(_=Q()).name,Object.prototype.hasOwnProperty.call(Ae.labelSet,b)||j({},me.UnknownLabel,_.name)),M(),null!==_||Ae.inIteration||j({},me.IllegalContinue),xe.createContinueStatement(_))),n);case"debugger":return xe.markEnd((N("debugger"),M(),xe.createDebuggerStatement()),n);case"do":return xe.markEnd((N("do"),v=Ae.inIteration,Ae.inIteration=!0,y=ne(),Ae.inIteration=v,N("while"),V("("),g=Y(),V(")"),O(";")&&A(),xe.createDoWhileStatement(y,g)),n);case"for":return xe.markEnd(ee(),n);case"function":return xe.markEnd(se(),n);case"if":return xe.markEnd((N("if"),V("("),h=Y(),V(")"),d=ne(),P("else")?(A(),m=ne()):m=null,xe.createIfStatement(h,d,m)),n);case"return":return xe.markEnd((p=null,N("return"),Ae.inFunctionBody||C({},me.IllegalReturn),32===ve.charCodeAt(_e)&&x(ve.charCodeAt(_e+1))?(p=Y(),M(),xe.createReturnStatement(p)):I()?xe.createReturnStatement(null):(O(";")||O("}")||Ee.type===ce.EOF||(p=Y()),M(),xe.createReturnStatement(p))),n);case"switch":return xe.markEnd(function(){var e,t,r,n,a;if(N("switch"),V("("),e=Y(),V(")"),V("{"),t=[],O("}"))return A(),xe.createSwitchStatement(e,t);for(n=Ae.inSwitch,a=!(Ae.inSwitch=!0);_e<Se&&!O("}");)null===(r=te()).test&&(a&&j({},me.MultipleDefaultsInSwitch),a=!0),t.push(r);return Ae.inSwitch=n,V("}"),xe.createSwitchStatement(e,t)}(),n);case"throw":return xe.markEnd((N("throw"),I()&&j({},me.NewlineAfterThrow),f=Y(),M(),xe.createThrowStatement(f)),n);case"try":return xe.markEnd(re(),n);case"var":return xe.markEnd((N("var"),c=Z(),M(),xe.createVariableDeclaration(c,"var")),n);case"while":return xe.markEnd((N("while"),V("("),o=Y(),V(")"),l=Ae.inIteration,Ae.inIteration=!0,u=ne(),Ae.inIteration=l,xe.createWhileStatement(o,u)),n);case"with":return xe.markEnd((be&&(E(),C({},me.StrictModeWith)),N("with"),V("("),i=Y(),V(")"),s=ne(),xe.createWithStatement(i,s)),n)}return(e=Y()).type===he.Identifier&&O(":")?(A(),r="$"+e.name,Object.prototype.hasOwnProperty.call(Ae.labelSet,r)&&j({},me.Redeclaration,"Label",e.name),Ae.labelSet[r]=!0,t=ne(),delete Ae.labelSet[r],xe.markEnd(xe.createLabeledStatement(e,t),n)):(M(),xe.markEnd(xe.createExpressionStatement(e),n))}function ae(){var e,t,r,n,a,i,s,o,u=[];for(o=Ee,V("{");_e<Se&&Ee.type===ce.StringLiteral&&(t=Ee,e=oe(),u.push(e),e.expression.type===he.Literal);)"use strict"===ve.slice(t.start+1,t.end-1)?(be=!0,r&&C(r,me.StrictOctalLiteral)):!r&&t.octal&&(r=t);for(n=Ae.labelSet,a=Ae.inIteration,i=Ae.inSwitch,s=Ae.inFunctionBody,Ae.labelSet={},Ae.inIteration=!1,Ae.inSwitch=!1,Ae.inFunctionBody=!0;_e<Se&&!O("}")&&void 0!==(e=oe());)u.push(e);return V("}"),Ae.labelSet=n,Ae.inIteration=a,Ae.inSwitch=i,Ae.inFunctionBody=s,xe.markEnd(xe.createBlockStatement(u),o)}function ie(e){var t,r,n,a,i,s,o=[];if(V("("),!O(")"))for(a={};_e<Se&&(r=Ee,t=Q(),i="$"+r.value,be?(y(r.value)&&(n=r,s=me.StrictParamName),Object.prototype.hasOwnProperty.call(a,i)&&(n=r,s=me.StrictParamDupe)):e||(y(r.value)?(e=r,s=me.StrictParamName):m(r.value)?(e=r,s=me.StrictReservedWord):Object.prototype.hasOwnProperty.call(a,i)&&(e=r,s=me.StrictParamDupe)),o.push(t),a[i]=!0,!O(")"));)V(",");return V(")"),{params:o,stricted:n,firstRestricted:e,message:s}}function se(){var e,t,r,n,a,i,s,o,u,l;return u=Ee,N("function"),r=Ee,e=Q(),be?y(r.value)&&C(r,me.StrictFunctionName):y(r.value)?(i=r,s=me.StrictFunctionName):m(r.value)&&(i=r,s=me.StrictReservedWord),l=(a=ie(i)).params,n=a.stricted,i=a.firstRestricted,a.message&&(s=a.message),o=be,t=ae(),be&&i&&j(i,s),be&&n&&C(n,s),be=o,xe.markEnd(xe.createFunctionDeclaration(e,l,[],t),u)}function oe(){if(Ee.type===ce.Keyword)switch(Ee.value){case"const":case"let":return e=Ee.value,r=Ee,N(e),t=Z(e),M(),xe.markEnd(xe.createVariableDeclaration(t,e),r);case"function":return se();default:return ne()}var e,t,r;return Ee.type!==ce.EOF?ne():void 0}function ue(){var e,t;return E(),w(),t=Ee,be=!1,e=function(){for(var e,t,r,n=[];_e<Se&&(t=Ee).type===ce.StringLiteral&&(e=oe(),n.push(e),e.expression.type===he.Literal);)"use strict"===ve.slice(t.start+1,t.end-1)?(be=!0,r&&C(r,me.StrictOctalLiteral)):!r&&t.octal&&(r=t);for(;_e<Se&&void 0!==(e=oe());)n.push(e);return n}(),xe.markEnd(xe.createProgram(e),t)}function le(){var e,t,r,n=[];for(e=0;e<Ie.tokens.length;++e)r={type:(t=Ie.tokens[e]).type,value:t.value},Ie.range&&(r.range=t.range),Ie.loc&&(r.loc=t.loc),n.push(r);Ie.tokens=n}var ce,fe,pe,he,de,me,ye,ge,ve,be,_e,we,ke,Se,xe,Ee,Ae,Ie;(fe={})[(ce={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",fe[ce.EOF]="<end>",fe[ce.Identifier]="Identifier",fe[ce.Keyword]="Keyword",fe[ce.NullLiteral]="Null",fe[ce.NumericLiteral]="Numeric",fe[ce.Punctuator]="Punctuator",fe[ce.StringLiteral]="String",fe[ce.RegularExpression]="RegularExpression",pe=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],he={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},de={Data:1,Get:2,Set:4},me={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},ye={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},ge={name:"SyntaxTree",processComment:function(e){var t,r;if(!(e.type===he.Program&&0<e.body.length)){for(0<Ie.trailingComments.length?Ie.trailingComments[0].range[0]>=e.range[1]?(r=Ie.trailingComments,Ie.trailingComments=[]):Ie.trailingComments.length=0:0<Ie.bottomRightStack.length&&Ie.bottomRightStack[Ie.bottomRightStack.length-1].trailingComments&&Ie.bottomRightStack[Ie.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(r=Ie.bottomRightStack[Ie.bottomRightStack.length-1].trailingComments,delete Ie.bottomRightStack[Ie.bottomRightStack.length-1].trailingComments);0<Ie.bottomRightStack.length&&Ie.bottomRightStack[Ie.bottomRightStack.length-1].range[0]>=e.range[0];)t=Ie.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):0<Ie.leadingComments.length&&Ie.leadingComments[Ie.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=Ie.leadingComments,Ie.leadingComments=[]),r&&(e.trailingComments=r),Ie.bottomRightStack.push(e)}},markEnd:function(e,t){return Ie.range&&(e.range=[t.start,_e]),Ie.loc&&(e.loc=new S(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),we,_e-ke),this.postProcess(e)),Ie.attachComment&&this.processComment(e),e},postProcess:function(e){return Ie.source&&(e.loc.source=Ie.source),e},createArrayExpression:function(e){return{type:he.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,r){return{type:he.AssignmentExpression,operator:e,left:t,right:r}},createBinaryExpression:function(e,t,r){return{type:"||"===e||"&&"===e?he.LogicalExpression:he.BinaryExpression,operator:e,left:t,right:r}},createBlockStatement:function(e){return{type:he.BlockStatement,body:e}},createBreakStatement:function(e){return{type:he.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:he.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:he.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,r){return{type:he.ConditionalExpression,test:e,consequent:t,alternate:r}},createContinueStatement:function(e){return{type:he.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:he.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:he.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:he.EmptyStatement}},createExpressionStatement:function(e){return{type:he.ExpressionStatement,expression:e}},createForStatement:function(e,t,r,n){return{type:he.ForStatement,init:e,test:t,update:r,body:n}},createForInStatement:function(e,t,r){return{type:he.ForInStatement,left:e,right:t,body:r,each:!1}},createFunctionDeclaration:function(e,t,r,n){return{type:he.FunctionDeclaration,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,r,n){return{type:he.FunctionExpression,id:e,params:t,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:he.Identifier,name:e}},createIfStatement:function(e,t,r){return{type:he.IfStatement,test:e,consequent:t,alternate:r}},createLabeledStatement:function(e,t){return{type:he.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:he.Literal,value:e.value,raw:ve.slice(e.start,e.end)}},createMemberExpression:function(e,t,r){return{type:he.MemberExpression,computed:"["===e,object:t,property:r}},createNewExpression:function(e,t){return{type:he.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:he.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:he.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:he.Program,body:e}},createProperty:function(e,t,r){return{type:he.Property,key:t,value:r,kind:e}},createReturnStatement:function(e){return{type:he.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:he.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:he.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:he.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:he.ThisExpression}},createThrowStatement:function(e){return{type:he.ThrowStatement,argument:e}},createTryStatement:function(e,t,r,n){return{type:he.TryStatement,block:e,guardedHandlers:t,handlers:r,finalizer:n}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:he.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:he.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:he.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:he.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:he.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:he.WithStatement,object:e,body:t}}},e.version="1.2.5",e.tokenize=function(e,t){var r,n;r=String,"string"==typeof e||e instanceof String||(e=r(e)),xe=ge,we=(_e=0)<(ve=e).length?1:0,ke=0,Se=ve.length,Ae={allowIn:!(Ee=null),labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ie={},(t=t||{}).tokens=!0,Ie.tokens=[],Ie.tokenize=!0,Ie.openParenToken=-1,Ie.openCurlyToken=-1,Ie.range="boolean"==typeof t.range&&t.range,Ie.loc="boolean"==typeof t.loc&&t.loc,"boolean"==typeof t.comment&&t.comment&&(Ie.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Ie.errors=[]);try{if(w(),Ee.type===ce.EOF)return Ie.tokens;for(A();Ee.type!==ce.EOF;)try{A()}catch(e){if(Ie.errors){Ie.errors.push(e);break}throw e}le(),n=Ie.tokens,void 0!==Ie.comments&&(n.comments=Ie.comments),void 0!==Ie.errors&&(n.errors=Ie.errors)}catch(e){throw e}finally{Ie={}}return n},e.parse=function(e,t){var r,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),xe=ge,we=(_e=0)<(ve=e).length?1:0,ke=0,Se=ve.length,Ae={allowIn:!(Ee=null),labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ie={},void 0!==t&&(Ie.range="boolean"==typeof t.range&&t.range,Ie.loc="boolean"==typeof t.loc&&t.loc,Ie.attachComment="boolean"==typeof t.attachComment&&t.attachComment,Ie.loc&&null!==t.source&&void 0!==t.source&&(Ie.source=n(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(Ie.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(Ie.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Ie.errors=[]),Ie.attachComment&&(Ie.range=!0,Ie.comments=[],Ie.bottomRightStack=[],Ie.trailingComments=[],Ie.leadingComments=[]));try{r=ue(),void 0!==Ie.comments&&(r.comments=Ie.comments),void 0!==Ie.tokens&&(le(),r.tokens=Ie.tokens),void 0!==Ie.errors&&(r.errors=Ie.errors)}catch(e){throw e}finally{Ie={}}return r},e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),he)he.hasOwnProperty(e)&&(t[e]=he[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()})},{}],9:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function l(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,a,i,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(l(r=this._events[e]))return!1;if(o(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(u(r))for(a=Array.prototype.slice.call(arguments,1),n=(s=r.slice()).length,i=0;i<n;i++)s[i].apply(this,a);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var r;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&((r=l(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<r&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,a,i;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(r=this._events[e]).length,n=-1,r===t||o(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(r)){for(i=a;0<i--;)if(r[i]===t||r[i].listener&&r[i].listener===t){n=i;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(o(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],10:[function(e,t,r){"use strict";t.exports=function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=r;return t}},{}],11:[function(e,t,r){t.exports=function(e){return!(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}},{}],12:[function(e,t,r){"use strict";function a(e){if(!e)return s;for(var t=0;t<e.args.length;++t){var r=e.args[t];e.args[t]=0===t?{name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:r,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function n(e){for(var t=[],r=0;r<e.args.length;++r)t.push("a"+r);var n;return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(i({args:(n=e).args,pre:a(n.pre),body:a(n.body),post:a(n.proc),funcName:n.funcName}))}var i=e("cwise-compiler"),s={body:"",args:[],thisVars:[],localVars:[]},o={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in o){var t=o[e];r[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),r[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in u){var t=u[e];r[e]=n({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),r[e+"eq"]=n({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in l){var t=l[e];r[e]=n({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"s"]=n({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"eq"]=n({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),r[e+"seq"]=n({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),r[t+"eq"]=n({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var f=["max","min","atan2","pow"];!function(){for(var e=0;e<f.length;++e){var t=f[e];r[t]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),r[t+"s"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),r[t+"eq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),r[t+"seq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var p=["atan2","pow"];!function(){for(var e=0;e<p.length;++e){var t=p[e];r[t+"op"]=n({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),r[t+"ops"]=n({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),r[t+"opeq"]=n({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),r[t+"opseq"]=n({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),r.any=i({args:["array"],pre:s,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),r.all=i({args:["array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),r.sum=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),r.prod=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),r.norm2squared=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),r.norm2=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),r.norminf=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),r.norm1=i({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),r.sup=i({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.inf=i({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.argmin=i({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.argmax=i({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.random=n({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),r.assign=n({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),r.assigns=n({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),r.equals=i({args:["array","array"],pre:s,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":1}],13:[function(e,t,r){"use strict";var i=e("ndarray"),s=e("./doConvert.js");t.exports=function(e,t){for(var r=[],n=e,a=1;n instanceof Array;)r.push(n.length),a*=n.length,n=n[0];return 0===r.length?i():(t||(t=i(new Float64Array(a),r)),s(t,e),t)}},{"./doConvert.js":14,ndarray:16}],14:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":1}],15:[function(e,t,r){"use strict";var n=e("dup"),a=e("cwise/lib/wrapper")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{var _inline_1_a,_inline_1_e=_inline_1_arg1_;for(_inline_1_a=0;_inline_1_a<_inline_1_arg2_.length-1;++_inline_1_a)_inline_1_e=_inline_1_e[_inline_1_arg2_[_inline_1_a]];_inline_1_e[_inline_1_arg2_[_inline_1_arg2_.length-1]]=_inline_1_arg0_}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_a","_inline_1_e"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:!1,funcName:"unpackCwise",blockSize:64});t.exports=function(e){var t=n(e.shape);return a(e,t),t}},{"cwise/lib/wrapper":6,dup:7}],16:[function(e,t,r){function a(e,t){return e[0]-t[0]}function m(){var e,t=this.stride,r=new Array(t.length);for(e=0;e<r.length;++e)r[e]=[Math.abs(t[e]),e];r.sort(a);var n=new Array(r.length);for(e=0;e<n.length;++e)n[e]=r[e][1];return n}function l(e,t){var r=["View",t,"d",e].join("");t<0&&(r="View_Nil"+e);var n="generic"===e;if(-1===t){var a="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";return new Function(a)()}if(0===t){a="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";return new Function("TrivialArray",a)(g[e][0])}a=["'use strict'"];var i=y(t),s=i.map(function(e){return"i"+e}),o="this.offset+"+i.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),u=i.map(function(e){return"b"+e}).join(","),l=i.map(function(e){return"c"+e}).join(",");a.push("function "+r+"(a,"+u+","+l+",d){this.data=a","this.shape=["+u+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+i.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+r+"_order(){"),2===t?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+r+"_set("+s.join(",")+",v){"),n?a.push("return this.data.set("+o+",v)}"):a.push("return this.data["+o+"]=v}"),a.push("proto.get=function "+r+"_get("+s.join(",")+"){"),n?a.push("return this.data.get("+o+")}"):a.push("return this.data["+o+"]}"),a.push("proto.index=function "+r+"_index(",s.join(),"){return "+o+"}"),a.push("proto.hi=function "+r+"_hi("+s.join(",")+"){return new "+r+"(this.data,"+i.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+i.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var c=i.map(function(e){return"a"+e+"=this.shape["+e+"]"}),f=i.map(function(e){return"c"+e+"=this.stride["+e+"]"});a.push("proto.lo=function "+r+"_lo("+s.join(",")+"){var b=this.offset,d=0,"+c.join(",")+","+f.join(","));for(var p=0;p<t;++p)a.push("if(typeof i"+p+"==='number'&&i"+p+">=0){d=i"+p+"|0;b+=c"+p+"*d;a"+p+"-=d}");a.push("return new "+r+"(this.data,"+i.map(function(e){return"a"+e}).join(",")+","+i.map(function(e){return"c"+e}).join(",")+",b)}"),a.push("proto.step=function "+r+"_step("+s.join(",")+"){var "+i.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+i.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(p=0;p<t;++p)a.push("if(typeof i"+p+"==='number'){d=i"+p+"|0;if(d<0){c+=b"+p+"*(a"+p+"-1);a"+p+"=ceil(-a"+p+"/d)}else{a"+p+"=ceil(a"+p+"/d)}b"+p+"*=d}");a.push("return new "+r+"(this.data,"+i.map(function(e){return"a"+e}).join(",")+","+i.map(function(e){return"b"+e}).join(",")+",c)}");var h=new Array(t),d=new Array(t);for(p=0;p<t;++p)h[p]="a[i"+p+"]",d[p]="b[i"+p+"]";a.push("proto.transpose=function "+r+"_transpose("+s+"){"+s.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+h.join(",")+","+d.join(",")+",this.offset)}"),a.push("proto.pick=function "+r+"_pick("+s+"){var a=[],b=[],c=this.offset");for(p=0;p<t;++p)a.push("if(typeof i"+p+"==='number'&&i"+p+">=0){c=(c+this.stride["+p+"]*i"+p+")|0}else{a.push(this.shape["+p+"]);b.push(this.stride["+p+"])}");return a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+i.map(function(e){return"shape["+e+"]"}).join(",")+","+i.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",a.join("\n"))(g[e],m)}var y=e("iota-array"),c=e("is-buffer"),f="undefined"!=typeof Float64Array,g={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(e,t,r,n){if(void 0===e)return(0,g.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===r){r=new Array(a);for(var i=a-1,s=1;0<=i;--i)r[i]=s,s*=t[i]}if(void 0===n)for(i=n=0;i<a;++i)r[i]<0&&(n-=(t[i]-1)*r[i]);for(var o=function(e){if(c(e))return"buffer";if(f)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}(e),u=g[o];u.length<=a+1;)u.push(l(o,u.length-1));return(0,u[a+1])(e,t,r,n)}},{"iota-array":10,"is-buffer":11}],17:[function(e,t,r){"use strict";t.exports=function(e,t,r){return 0===e.length?e:t?(r||e.sort(t),function(e,t){for(var r=1,n=e.length,a=e[0],i=e[0],s=1;s<n;++s)if(i=a,t(a=e[s],i)){if(s===r){r++;continue}e[r++]=a}return e.length=r,e}(e,t)):(r||e.sort(),function(e){for(var t=1,r=e.length,n=e[0],a=e[0],i=1;i<r;++i,a=n)if(a=n,(n=e[i])!==a){if(i===t){t++;continue}e[t++]=n}return e.length=t,e}(e))}},{}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0});var k=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(a)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),i=e("events"),S=n(e("ndarray")),x=n(e("ndarray-ops")),m=n(e("ndarray-pack")),s=n(e("ndarray-unpack")),E=n(e("cwise")),y=n(e("./randn")),u=n(e("./pairwise-distances")),l=n(e("./joint-probabilities")),A=n(e("./kl-divergence")),o=function(e){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Object.getPrototypeOf(r).call(this));return e=e||{},t.dim=e.dim||2,t.perplexity=e.perplexity||30,t.earlyExaggeration=e.earlyExaggeration||4,t.learningRate=e.learningRate||1e3,t.nIter=e.nIter||1e3,t.metric=e.metric||"euclidean",t.barneshut=e.barneshut||!1,t.inputData=null,t.outputEmbedding=null,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,i.EventEmitter),a(r,[{key:"init",value:function(e){var r=(e=e||{}).data||[],t=e.type||"dense";if("dense"===t)this.inputData=(0,m.default)(r);else{if("sparse"!==t)throw new Error("input data type must be dense or sparse");for(var n=[],a=1,i=function(t){var e=Math.max.apply(null,r.map(function(e){return e[t]}))+1;n.push(e),a*=e},s=0;s<r[0].length;s++)i(s);this.inputData=(0,S.default)(new Float64Array(a),n);var o=!0,u=!1,l=void 0;try{for(var c,f=r[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var p,h=c.value;(p=this.inputData).set.apply(p,d(h).concat([1]))}}catch(e){u=!0,l=e}finally{try{!o&&f.return&&f.return()}finally{if(u)throw l}}}this.outputEmbedding=(0,y.default)(this.inputData.shape[0],this.dim)}},{key:"run",value:function(){this.emit("progressStatus","Calculating pairwise distances"),this.distances=(0,u.default)(this.inputData,this.metric),this.emit("progressStatus","Calculating joint probabilities"),this.alpha=Math.max(this.dim-1,1),this.P=(0,l.default)(this.distances,this.perplexity);var e=Number.MAX_VALUE,t=0;this.emit("progressStatus","Early exaggeration with momentum 0.5"),x.default.mulseq(this.P,this.earlyExaggeration);var r=this._gradDesc(t,50,.5,0,0),n=k(r,2);n[0],t=n[1],this.emit("progressStatus","Early exaggeration with momentum 0.8");var a=this._gradDesc(t+1,100,.8,0,0),i=k(a,2);i[0],t=i[1],this.emit("progressStatus","Final optimization with momentum 0.8"),x.default.divseq(this.P,this.earlyExaggeration);var s=this._gradDesc(t+1,this.nIter,.8,1e-6,1e-6),o=k(s,2);return e=o[0],t=o[1],this.emit("progressStatus","Optimization end"),[e,t]}},{key:"rerun",value:function(){this.outputEmbedding=(0,y.default)(this.inputData.shape[0],this.dim);var e=this.run(),t=k(e,2);return[t[0],t[1]]}},{key:"getOutput",value:function(){return(0,s.default)(this.outputEmbedding)}},{key:"getOutputScaled",value:function(){for(var e=(0,S.default)(new Float64Array(this.outputEmbedding.size),this.outputEmbedding.shape),t=(0,S.default)(new Float64Array(this.outputEmbedding.shape[0]),[this.outputEmbedding.shape[0]]),r=0;r<this.outputEmbedding.shape[1];r++){var n=x.default.sup(x.default.abs(t,this.outputEmbedding.pick(null,r)));x.default.divs(e.pick(null,r),this.outputEmbedding.pick(null,r),n)}return(0,s.default)(e)}},{key:"_gradDesc",value:function(e,t,r){for(var n=arguments.length<=3||void 0===arguments[3]?1e-6:arguments[3],a=arguments.length<=4||void 0===arguments[4]?1e-6:arguments[4],i=(0,S.default)(new Float64Array(this.outputEmbedding.size),this.outputEmbedding.shape),s=new Float64Array(this.outputEmbedding.size),o=0;o<s.length;o++)s[o]=1;var u=(0,S.default)(s,this.outputEmbedding.shape),l=Number.MAX_VALUE,c=Number.MAX_VALUE,f=0,p=(0,E.default)({args:["array"],pre:function(e){this.sum=0},body:function(e){this.sum+=e*e},post:function(e){return Math.sqrt(this.sum)}}),h=(0,E.default)({args:["array","array","array"],body:function(e,t,r){0<=t*r?e+=.05:e*=.95,e=Math.max(e,.01)}}),d=void 0;for(d=e;d<t;d++){var m=(0,A.default)(this.outputEmbedding,this.P,this.alpha),y=k(m,2),g=y[0],v=y[1],b=Math.abs(g-l);l=g;var _=p(v);if(this.emit("progressIter",[d,l,_]),l<c)c=l,f=d;else if(30<d-f)break;if(_<=n)break;if(b<=a)break;h(u,i,v),x.default.muleq(v,u);var w=(0,S.default)(new Float64Array(v.size),v.shape);x.default.muls(w,v,this.learningRate),x.default.mulseq(i,r),x.default.subeq(i,w),x.default.addeq(this.outputEmbedding,i),this.emit("progressData",this.getOutputScaled())}return[l,d]}}]),r}();r.default=o,t.exports=r.default},{"./joint-probabilities":19,"./kl-divergence":20,"./pairwise-distances":21,"./randn":22,cwise:5,events:9,ndarray:16,"ndarray-ops":12,"ndarray-pack":13,"ndarray-unpack":15}],19:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){for(var r=e.shape[0],n=(0,y.default)(new Float64Array(r*r),[r,r]),a=(0,y.default)(new Float64Array(r*r),[r,r]),i=void 0,s=void 0,o=1/0,u=Math.log(t),l=void 0,c=void 0,f=void 0,p=0;p<r;p++){s=-(i=1)/0,o=1/0;for(var h=0;h<100;h++){for(var d=0;d<r;d++)n.set(p,d,Math.exp(-e.get(p,d)*i));n.set(p,p,0);for(d=c=0;d<r;d++)c+=n.get(p,d);0==c&&(c=v);for(d=f=0;d<r;d++)n.set(p,d,n.get(p,d)/c),f+=e.get(p,d)*n.get(p,d);if(l=Math.log(c)+i*f-u,Math.abs(l)<=_)break;0<l?(s=i,i=o==1/0?2*i:(i+o)/2):(o=i,s==-1/0?i/=2:i=(i+s)/2)}i}g.default.add(a,n,n.transpose(1,0));var m=Math.max(g.default.sum(a),b);return g.default.divseq(a,m),g.default.maxseq(a,b),a};var y=n(e("ndarray")),g=n(e("ndarray-ops")),v=1e-7,b=Number.EPSILON||2220446049250313e-31,_=1e-5;t.exports=r.default},{ndarray:16,"ndarray-ops":12}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){var n=e.shape[0],a=e.shape[1],i=(0,v.default)(new Float64Array(n*n),[n,n]),s=(0,_.default)(e,"euclidean");k(s);var o=(r+1)/-2;b.default.powseq(b.default.divseq(b.default.addseq(s,1),r),o);for(var u=0;u<n;u++)s.set(u,u,0);var l=Math.max(b.default.sum(s),w);b.default.divs(i,s,l),b.default.maxseq(i,w);var c=(0,v.default)(new Float64Array(n*n),[n,n]),f=(0,v.default)(new Float64Array(n*n),[n,n]);b.default.div(c,t,i),b.default.logeq(c),b.default.assign(f,t);var p=b.default.sum(b.default.muleq(c,f)),h=(0,v.default)(new Float64Array(e.size),e.shape),d=(0,v.default)(new Float64Array(n*n),[n,n]);b.default.sub(d,t,i),b.default.muleq(d,s);for(u=0;u<n;u++)for(var m=0;m<a;m++){var y=(0,v.default)(new Float64Array(e.shape[0]),[e.shape[0]]);b.default.assign(y,e.pick(null,m)),b.default.addseq(b.default.negeq(y),e.get(u,m)),b.default.muleq(y,d.pick(u,null)),h.set(u,m,b.default.sum(y))}var g=2*(r+1)/r;return b.default.mulseq(h,g),[p,h]};var v=n(e("ndarray")),b=n(e("ndarray-ops")),a=n(e("cwise")),_=n(e("./pairwise-distances")),w=Number.EPSILON||2220446049250313e-31,k=(0,a.default)({args:["array"],body:function(e){e*=e}});t.exports=r.default},{"./pairwise-distances":21,cwise:5,ndarray:16,"ndarray-ops":12}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=e.shape[0],n=(0,o.default)(new Float64Array(r*r),[r,r]);switch(t){case"euclidean":for(var a=0;a<r;a++)for(var i=a+1;i<r;i++){var s=u(e.pick(a,null),e.pick(i,null));n.set(a,i,s),n.set(i,a,s)}break;case"manhattan":for(a=0;a<r;a++)for(i=a+1;i<r;i++){s=l(e.pick(a,null),e.pick(i,null));n.set(a,i,s),n.set(i,a,s)}break;case"jaccard":for(a=0;a<r;a++)for(i=a+1;i<r;i++){s=c(e.pick(a,null),e.pick(i,null));n.set(a,i,s),n.set(i,a,s)}break;case"dice":for(a=0;a<r;a++)for(i=a+1;i<r;i++){s=f(e.pick(a,null),e.pick(i,null));n.set(a,i,s),n.set(i,a,s)}}return n};var o=n(e("ndarray")),a=n(e("cwise")),u=(0,a.default)({args:["array","array"],pre:function(e,t){this.sum=0},body:function(e,t){var r=e-t;this.sum+=r*r},post:function(e,t){return Math.sqrt(this.sum)}}),l=(0,a.default)({args:["array","array"],pre:function(e,t){this.sum=0},body:function(e,t){this.sum+=Math.abs(e-t)},post:function(e,t){return this.sum}}),c=(0,a.default)({args:["array","array"],pre:function(e,t){this.tf=0,this.tt=0},body:function(e,t){var r=Math.round(e),n=Math.round(t);this.tf+=+(r!=n),this.tt+=+(1==r&&1==n)},post:function(e,t){return this.tf+this.tt===0?1:this.tf/(this.tf+this.tt)}}),f=(0,a.default)({args:["array","array"],pre:function(e,t){this.tf=0,this.tt=0},body:function(e,t){var r=Math.round(e),n=Math.round(t);this.tf+=+(r!=n),this.tt+=+(1==r&&1==n)},post:function(e,t){return this.tf+this.tt===0?1:this.tf/(this.tf+2*this.tt)}});t.exports=r.default},{cwise:5,ndarray:16}],22:[function(e,t,r){"use strict";function a(){var e=2*Math.random()-1,t=2*Math.random()-1,r=e*e+t*t;return 0==r||1<r?a():e*Math.sqrt(-2*Math.log(r)/r)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){for(var r=new Float64Array(e*t),n=0;n<r.length;n++)r[n]=1e-4*a();return(0,s.default)(r,[e,t])};var n,i=e("ndarray"),s=(n=i)&&n.__esModule?n:{default:n};t.exports=r.default},{ndarray:16}]},{},[18])(18)}),self.onmessage=function(e){var t,r=e.data,n=100,a=new TSNE({dim:r.dim||2,perplexity:r.perplexity||25,earlyExaggeration:r.earlyExaggeration||4,learningRate:r.learningRate||25,nIter:r.nIter||1e3,metric:r.metric||"euclidean"});a.init({data:r.data,type:"dense"}),a.on("progressData",function(e){self.postMessage({pos:a.getOutputScaled()})}),a.on("progressIter",function(e){n=.9*n+e[1],self.postMessage({iterations:e[0],cost:e[1],stop:n<20})}),t=a.run(),self.postMessage({err:t[0],iterations:t[1],stop:!0})};